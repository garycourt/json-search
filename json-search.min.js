var O={};function F(){}function typeOf(a){return a===void 0?"undefined":a===null?"null":Object.prototype.toString.call(a).split(" ").pop().split("]").shift().toLowerCase()}typeof exports==="undefined"&&(exports={});typeof require!=="function"&&(require=function(){return exports});if(typeof Object.create!=="function")Object.create=function(a){F.prototype=a;return new F};if(typeof Array.isArray!=="function")Array.isArray=function(a){return typeOf(a)==="array"};
if(typeof Array.add!=="function")Array.add=function(a,b){if(a.indexOf(b)===-1)return a[a.length]=b,!0;return!1};if(typeof Array.remove!=="function")Array.remove=function(a,b){var c=a.indexOf(b);if(c!==-1)return a.splice(c,1),!0;return!1};if(!Array.append)Array.append=function(a,b){b=b.slice(0);b.unshift(a.length,0);a.splice.apply(a,b);return a};
if(typeof Array.orderedInsert!=="function")Array.orderedInsert=function(a,b,c){var d,e,g;if(a.length===0)a[0]=b;else{d=0;e=a.length-1;for(g=Math.floor(e/2);d<e;)c(a[g],b)<=0?d=g+1:e=g-1,g=Math.round(d+(e-d)/2);d===e?c(a[d],b)<=0?a.splice(d+1,0,b):a.splice(d,0,b):a.splice(e+1,0,b)}};function Stream(){}Stream.prototype._streamInput=null;Stream.prototype._streamOutput=null;Stream.prototype._streamBuffer=null;Stream.prototype._streamPaused=!1;Stream.prototype._streamEnded=!1;
Stream.prototype._streamError=null;Stream.prototype._streamDraining=!1;
Stream.prototype._streamDrain=function(){var a,b,c;if(this._streamBuffer&&!this._streamPaused&&!this._streamDraining){this._streamDraining=!0;try{for(a=0;!this._streamPaused&&a<this._streamBuffer.length;++a)if(this._streamBuffer[a].length>1)if(this.onBulkWrite!==Stream.prototype.onBulkWrite)this.onBulkWrite(this._streamBuffer[a]);else{b=0;for(c=this._streamBuffer[a].length;!this._streamPaused&&b<c;++b)this.onWrite(this._streamBuffer[a][b]);if(b<c){this._streamBuffer[a]=this._streamBuffer[a].slice(b);
break}}else if(this._streamBuffer[a].length===1)this.onWrite(this._streamBuffer[a][0])}catch(d){this.error(d),a=this._streamBuffer.length}if(!this._streamPaused&&a>=this._streamBuffer.length){if(this._streamBuffer=null,this._streamEnded)try{if(this._streamError)this.onError(this._streamError);else this.onEnd()}catch(e){}}else this._streamBuffer=this._streamBuffer.slice(a);this._streamDraining=!1}};
Stream.prototype.pipe=function(a){if(this._streamOutput)throw Error("Stream already has an output");if(a._streamInput)throw Error("Output stream already has an input");this._streamOutput=a;a._streamInput=this;a._streamEnded=!1;a._streamError=null;a.onStart(this)};Stream.prototype.write=function(a){if(this._streamPaused){if(!this._streamBuffer)this._streamBuffer=[];this._streamBuffer[this._streamBuffer.length]=[a]}else this.onWrite(a)};Stream.prototype.emit=function(a){this._streamOutput&&this._streamOutput.write(a)};
Stream.prototype.bulkWrite=function(a){if(this._streamPaused){if(!this._streamBuffer)this._streamBuffer=[];this._streamBuffer[this._streamBuffer.length]=a}else this.onBulkWrite(a)};Stream.prototype.emitBulk=function(a){this._streamOutput&&this._streamOutput.bulkWrite(a)};Stream.prototype.isPaused=function(){return this._streamPaused};Stream.prototype.pause=function(){if(!this._streamPaused){this._streamPaused=!0;if(this.onPause)this.onPause();this._streamInput&&this._streamInput.pause()}};
Stream.prototype.resume=function(){var a=this;if(this._streamPaused){this._streamPaused=!1;if(this.onResume)this.onResume();this._streamBuffer&&setTimeout(function(){a._streamDrain()},0);this._streamInput&&this._streamInput.resume()}};Stream.prototype.end=function(){if(!this._streamEnded)if(this._streamEnded=!0,!this._streamPaused&&!this._streamBuffer)this.onEnd();else if(!this._streamBuffer)this._streamBuffer=[]};
Stream.prototype.emitEnd=function(){this._streamEnded=!0;if(this._streamOutput)this._streamOutput.end(),this._streamOutput=this._streamOutput._streamInput=null};Stream.prototype.error=function(a){if(!this._streamEnded)if(this._streamEnded=!0,this._streamError=a,!this._streamPaused&&!this._streamBuffer)this.onError(a);else if(!this._streamBuffer)this._streamBuffer=[]};
Stream.prototype.emitError=function(a){this._streamEnded=!0;this._streamError=a;if(this._streamOutput)this._streamOutput.error(a),this._streamOutput=this._streamOutput._streamInput=null};Stream.prototype.onStart=function(){};Stream.prototype.onWrite=Stream.prototype.emit;Stream.prototype.onBulkWrite=function(a){if(this.onWrite!==Stream.prototype.onWrite){if(!this._streamBuffer)this._streamBuffer=[];this._streamBuffer[this._streamBuffer.length]=a;this._streamDrain()}else this.emitBulk(a)};
Stream.prototype.onEnd=Stream.prototype.emitEnd;Stream.prototype.onError=Stream.prototype.emitError;exports.Stream=Stream;function Collector(a){Stream.call(this);this.collection=[];this.callback=a||null}Collector.prototype=Object.create(Stream.prototype);Collector.prototype.callback=null;Collector.prototype.onWrite=function(a){this.collection.push(a)};Collector.prototype.onBulkWrite=function(a){this.collection=this.collection.concat(a)};
Collector.prototype.onEnd=function(){if(this.callback)this.callback(null,this.collection),this.callback=null};Collector.prototype.onError=function(a){if(this.callback)this.callback(a),this.callback=null};exports.Collector=Collector;function SingleCollector(a){Stream.call(this);this.listener=a}SingleCollector.prototype=Object.create(Stream.prototype);
SingleCollector.prototype.onWrite=function(a){if(typeof this.data!=="undefined")throw Error("Stream is full");this.data=a;this.listener&&this.listener(null,a);typeof this.data!=="undefined"&&this.pause()};SingleCollector.prototype.drain=function(){this.data=void 0;this.resume()};SingleCollector.prototype.onEnd=function(){if(this.listener)this.listener(!0),this.listener=null;this.emitEnd()};SingleCollector.prototype.onError=function(a){if(this.listener)this.listener(a),this.listener=null;this.emitError(a)};
exports.SingleCollector=SingleCollector;function DefaultTermIndexer(){}
DefaultTermIndexer.prototype.index=function(a,b,c){var d,e,g=[];switch(typeOf(a)){case "null":case "boolean":case "number":g[0]={term:a,field:c||null,documentID:b};break;case "string":a=a.replace(/[^\w\d]/g," ").replace(/\s\s/g," ").toLowerCase().split(" ");d={};for(e=0;e<a.length;++e)d[a[e]]?(d[a[e]].termFrequency++,d[a[e]].termPositions.push(e)):d[a[e]]={term:a[e],termFrequency:1,termPositions:[e],field:c,totalFieldTokens:a.length,documentID:b};for(e in d)d[e]!==O[e]&&(g[g.length]=d[e]);break;case "object":for(e in a)a[e]!==
O[e]&&(g=g.concat(this.index(a[e],b,c?c+"."+e:e)));break;case "array":for(e=0;e<a.length;++e)g=g.concat(this.index(a[e],b,c?c+"."+e:String(e)))}return g};DefaultTermIndexer.prototype.toSource=function(){};exports.DefaultTermIndexer=DefaultTermIndexer;function MemoryIndex(){this._docs={};this._index={};this._indexKeys=[]}MemoryIndex.documentIDComparator=function(a,b){if(a.documentID<b.documentID)return-1;else if(a.documentID>b.documentID)return 1;return 0};
MemoryIndex.stringComparator=function(a,b){if(a<b)return-1;else if(a>b)return 1;return 0};MemoryIndex.prototype._docCount=0;MemoryIndex.prototype._termIndexer=new DefaultTermIndexer;MemoryIndex.prototype.generateID=function(){return String(Math.random())};
MemoryIndex.prototype.indexDocument=function(a,b,c){var d,e,a=this._termIndexer.index(a,b),b=0;for(d=a.length;b<d;++b)e=JSON.stringify([a[b].field,a[b].term]),this._index[e]?Array.orderedInsert(this._index[e],a[b],MemoryIndex.documentIDComparator):this._index[e]=[a[b]],Array.orderedInsert(this._indexKeys,e,MemoryIndex.stringComparator);c&&c(null)};
MemoryIndex.prototype.addDocument=function(a,b,c){b=typeof b==="undefined"||typeOf(b)==="null"?this.generateID():String(b);this._docs[b]=a;this._docCount++;this.indexDocument(a,b,c)};MemoryIndex.prototype.getDocument=function(a,b){b(null,this._docs[a])};MemoryIndex.prototype.setTermIndexer=function(a,b){var c=this._docs,d;this._termIndexer=a;this._index={};for(d in c)c.hasOwnProperty(d)&&this.indexDocument(c[d],d);b&&b(null)};
MemoryIndex.prototype.getTermVectors=function(a,b){var c=this._index[JSON.stringify([a,b])]||[],d=new Stream;d.pause();d.bulkWrite(c);d.end();d.resume();return d};
MemoryIndex.prototype.getTermRangeVectors=function(a,b,c,d,e){var b=JSON.stringify([a,b]),a=JSON.stringify([a,c]),c=this.indexOfKey(b),g=this._indexKeys.length,i=[],o=new Stream;d&&this._indexKeys[c]===b&&++c;if(e)for(;c<g&&this._indexKeys[c]<a;)i=i.concat(this._index[this._indexKeys[c]]),++c;else for(;c<g&&this._indexKeys[c]<=a;)i=i.concat(this._index[this._indexKeys[c]]),++c;setTimeout(function(){o.bulkWrite(entries);o.end()},0);return o};
MemoryIndex.prototype.indexOfKey=function(a){var b=this._indexKeys,c,d,e;if(b.length===0)return 0;c=0;d=b.length-1;for(e=Math.floor(d/2);c<d;){if(b[e]===a)return e;else b[e]<a?c=e+1:d=e-1;e=Math.round(c+(d-c)/2)}if(c===d)return b[c]<a?c+1:c;return d+1};exports.MemoryIndex=MemoryIndex;function BooleanClause(a,b){this.query=a;this.occur=b||Occur.SHOULD}var Occur={MUST:1,SHOULD:0,MUST_NOT:-1};exports.BooleanQuery=BooleanQuery;exports.Occur=Occur;
function BooleanQuery(a,b,c){this.clauses=a||[];this.minimumOptionalMatches=b||0;this.boost=c||1}BooleanQuery.prototype.minimumOptionalMatches=0;BooleanQuery.prototype.boost=1;BooleanQuery.prototype.score=function(a,b){return new BooleanScorer(this,a,b)};BooleanQuery.prototype.extractTerms=function(){var a,b,c=[];a=0;for(b=this.clauses.length;a<b;++a)c=c.concat(this.clauses[a].query.extractTerms());return c};
BooleanQuery.prototype.rewrite=function(){var a,b,c,d=!1;if(this.minimumOptionalMatches===0&&this.clauses.length===1&&this.clauses[0].occur!==Occur.MUST_NOT)a=this.clauses[0].query,a=a.rewrite(),a.boost*=this.boost;else{a=new BooleanQuery;a.boost=this.boost;b=0;for(c=this.clauses.length;b<c;++b)a.clauses[b]=new BooleanClause(this.clauses[b].query.rewrite(),this.clauses[b].occur),a.clauses[b].query!==this.clauses[b].query&&(d=!0);d||(a=this)}return a};
function BooleanScorer(a,b,c){Stream.call(this);this._query=a;this._similarity=b;this._index=c;this._inputs=[];this.addInputs(a.clauses)}BooleanScorer.prototype=Object.create(Stream.prototype);BooleanScorer.prototype._collectorCount=0;
BooleanScorer.prototype.addInputs=function(a){var b=this;a.forEach(function(a){var d=new SingleCollector(function(a){a?a===!0?(e.collector=null,b._collectorCount--,b._collectorCount===0||e.occur===Occur.MUST?(b._collectorCount=0,b.end()):b._collectorCount>0&&b.match()):b.error(a):b.match()}),e=new BooleanClauseStream(a.query,a.occur,d);a.query.score(b._similarity,b._index).pipe(d);b._inputs.push(e);b._collectorCount++})};
BooleanScorer.prototype.match=function(){var a,b,c=[],d=0,e=!1,g=0,i;if(!this.isPaused()){a=0;for(b=this._inputs.length;a<b;++a){if(this._inputs[a].collector){if(c[a]=this._inputs[a].collector.data,typeof c[a]==="undefined")return}else c[a]=void 0;if(a>0&&(!c[d]||c[a]&&c[a].id<c[d].id))d=a}d=c[d].id;i=new DocumentTerms(d);a=0;for(b=this._inputs.length;a<b;++a)if(c[a]&&c[a].id===d)if(this._inputs[a].occur===Occur.MUST_NOT){e=!1;break}else this._inputs[a].occur===Occur.SHOULD&&g++,e=!0,i.terms=i.terms.concat(c[a].terms),
i.sumOfSquaredWeights+=c[a].sumOfSquaredWeights,i.score+=c[a].score;else if(this._inputs[a].occur===Occur.MUST){e=!1;break}e&&g>=this._query.minimumOptionalMatches&&(i.score*=this._query.boost,i.sumOfSquaredWeights*=this._query.boost*this._query.boost,this.emit(i));a=0;for(b=this._inputs.length;a<b;++a)c[a]&&c[a].id===d&&this._inputs[a].collector.drain()}};BooleanScorer.prototype.onResume=function(){var a=this;setTimeout(function(){a.match()},0)};
BooleanScorer.prototype.onEnd=function(){if(this._collectorCount)throw Error("BooleanScorer#end called while there are still collectors attached!");this.emitEnd();this._cleanup()};BooleanScorer.prototype.onError=function(a){this.emitError(a);this._cleanup()};BooleanScorer.prototype._cleanup=function(){var a,b;a=0;for(b=this._inputs.length;a<b;++a)this._inputs[a].collector&&this._inputs[a].collector.end();this._inputs=[]};
function BooleanClauseStream(a,b,c){this.query=a;this.occur=b;this.collector=c}BooleanClauseStream.prototype=Object.create(BooleanClause.prototype);exports.BooleanQuery=BooleanQuery;var DefaultSimilarity=function(){};DefaultSimilarity.prototype.norm=function(a){return(a.documentBoost||1)*(a.fieldBoost||1)*(1/Math.sqrt(a.totalFieldTokens||1))};DefaultSimilarity.prototype.queryNorm=function(a){return 1/Math.sqrt(a.sumOfSquaredWeights)};
DefaultSimilarity.prototype.tf=function(a){return Math.sqrt(a.termFrequency||1)};DefaultSimilarity.prototype.sloppyFreq=function(a){return 1/(a+1)};DefaultSimilarity.prototype.idf=function(a){return Math.log((a.totalDocuments||1)/((a.documentFrequency||1)+1))+1};DefaultSimilarity.prototype.coord=function(a,b){return a/b};exports.DefaultSimilarity=DefaultSimilarity;function DocumentTerms(a,b){this.id=a;this.terms=b||[]}DocumentTerms.prototype.terms=[];DocumentTerms.prototype.sumOfSquaredWeights=0;
DocumentTerms.prototype.score=0;exports.DocumentTerms=DocumentTerms;function FilterQuery(a,b,c){this.query=a;this.filter=b;this.boost=c||1}FilterQuery.prototype.boost=1;FilterQuery.prototype.score=function(a,b){var c=new FilterScorer(this,a);this.query.score(a,b).pipe(c);return c};FilterQuery.prototype.extractTerms=function(){return this.query.extractTerms()};FilterQuery.prototype.rewrite=function(){var a;do a=this.query,this.query=this.query.rewrite();while(this.query!==a);return this};
function FilterScorer(a,b){Stream.call(this);this._query=a;this._similarity=b;this._maxOverlap=a.extractTerms().length}FilterScorer.prototype=Object.create(Stream.prototype);FilterScorer.prototype.onWrite=function(a){var b=this._query.boost;this._query.filter(a)&&(a.score*=b,a.sumOfSquaredWeights*=b*b,this.emit(a))};
FilterScorer.prototype.onBulkWrite=function(a){var b,c;boost=this._query.boost;a=a.filter(this._query.filter);b=0;for(c=a.length;b<c;++b)filter(a[b])&&(a[b].score*=boost,a[b].sumOfSquaredWeights*=boost*boost);this.emitBulk(a)};exports.FilterQuery=FilterQuery;function NormalizedQuery(a,b){this.query=a;this.boost=b||1}NormalizedQuery.prototype.boost=1;NormalizedQuery.prototype.score=function(a,b){var c=new NormalizedScorer(this,a);this.query.score(a,b).pipe(c);return c};
NormalizedQuery.prototype.extractTerms=function(){return this.query.extractTerms()};NormalizedQuery.prototype.rewrite=function(){var a;do a=this.query,this.query=this.query.rewrite();while(this.query!==a);return this};function NormalizedScorer(a,b){Stream.call(this);this._query=a;this._similarity=b;this._maxOverlap=a.extractTerms().length}NormalizedScorer.prototype=Object.create(Stream.prototype);
NormalizedScorer.prototype.onWrite=function(a){a.score*=this._query.boost*this._similarity.queryNorm(a)*this._similarity.coord(a.terms.length,this._maxOverlap);this.emit(a)};NormalizedScorer.prototype.onBulkWrite=function(a){var b,c,d;b=0;for(c=a.length;b<c;++b)d=a[b],d.score*=this._query.boost*this._similarity.queryNorm(d)*this._similarity.coord(d.terms.length,this._maxOverlap);this.emitBulk(a)};exports.NormalizedQuery=NormalizedQuery;
function PhraseQuery(a,b,c,d){this.field=a||null;this.terms=b||[];this.slop=c||0;this.boost=d||1}PhraseQuery.prototype.field=null;PhraseQuery.prototype.slop=0;PhraseQuery.prototype.boost=1;PhraseQuery.prototype.score=function(){};PhraseQuery.prototype.extractTerms=function(){var a,b,c=[];a=0;for(b=this.terms.length;a<b;++a)typeof this.terms[a]!=="undefined"&&c.push({term:this.terms[a],field:this.field});return c};
PhraseQuery.prototype.rewrite=function(){if(this.terms.length===1&&typeof this.terms[0]!=="undefined")return new TermQuery(this.field,this.terms[0],this.boost);return this};exports.PhraseQuery=PhraseQuery;function PrefixQuery(a,b,c){this.prefix=a;this.field=b||null;this.boost=c||1}PrefixQuery.prototype.field=null;PrefixQuery.prototype.boost=1;PrefixQuery.prototype.score=function(a,b){return this.rewrite().score(a,b)};PrefixQuery.prototype.extractTerms=function(){return[{term:this.prefix,field:this.field}]};
PrefixQuery.prototype.rewrite=function(){var a=this.prefix.replace(/.$/,function(a){return String.fromCharCode(a.charCodeAt(0)+1)});return new TermRangeQuery(this.field,this.prefix,a,!1,!0,this.boost)};exports.PrefixQuery=PrefixQuery;function QueryParser(){}QueryParser.parse=function(a,b){var c,d;c=QueryParser.impl.parse(a,void 0,b||null);do d=c,c=c.rewrite();while(c!==d);return c};
QueryParser.impl=function(){var a={parse:function(a,c,d){function e(a){var b=a.charCodeAt(0);if(b<=255)var a="x",c=2;else a="u",c=4;var a="\\"+a,f=b.toString(16).toUpperCase(),b=f;c-=f.length;for(f=0;f<c;f++)b="0"+b;return a+b}function g(a){return'"'+a.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/[\x80-\uFFFF]/g,e)+'"'}function i(a){f<p||(f>p&&(p=f,t=[]),t.push(a))}function o(){var c="WHITESPACE@"+f,h=k[c];if(h)return f=h.nextPos,h.result;h=j;j=!1;if(a.substr(f).match(/^[ \t\n\r\u3000]/)!==
null){var l=a.charAt(f);f++}else l=null,j&&i("[ \t\\n\\r\\u3000]");(j=h)&&l===null&&i("whitespace");k[c]={nextPos:f,result:l};return l}function q(){var a="SKIP@"+f,b=k[a];if(b)return f=b.nextPos,b.result;for(var b=[],c=o();c!==null;)b.push(c),c=o();k[a]={nextPos:f,result:b};return b}function z(){var c="Number@"+f,h=k[c];if(h)return f=h.nextPos,h.result;h=j;j=!1;var l=f;if(a.substr(f).match(/^[0-9]/)!==null){var d=a.charAt(f);f++}else d=null,j&&i("[0-9]");if(d!==null)for(var e=[];d!==null;)e.push(d),
a.substr(f).match(/^[0-9]/)!==null?(d=a.charAt(f),f++):(d=null,j&&i("[0-9]"));else e=null;if(e!==null){d=f;if(a.substr(f,1)==="."){var m=".";f+=1}else m=null,j&&i('"."');if(m!==null){if(a.substr(f).match(/^[0-9]/)!==null){var g=a.charAt(f);f++}else g=null,j&&i("[0-9]");if(g!==null)for(var r=[];g!==null;)r.push(g),a.substr(f).match(/^[0-9]/)!==null?(g=a.charAt(f),f++):(g=null,j&&i("[0-9]"));else r=null;r!==null?m=[m,r]:(m=null,f=d)}else m=null,f=d;d=m!==null?m:"";d!==null?e=[e,d]:(e=null,f=l)}else e=
null,f=l;l=e!==null?parseFloat(e[0].concat(e[1][0],e[1][1]).join("")):null;(j=h)&&l===null&&i("number");k[c]={nextPos:f,result:l};return l}function A(){var c="ESCAPED_CHAR@"+f,h=k[c];if(h)return f=h.nextPos,h.result;h=f;if(a.substr(f,1)==="\\"){var l="\\";f+=1}else l=null,j&&i('"\\\\"');if(l!==null){if(a.length>f){var d=a.charAt(f);f++}else d=null,j&&i("any character");d!==null?l=[l,d]:(l=null,f=h)}else l=null,f=h;k[c]={nextPos:f,result:l};return l}function u(){var c="TERM_START_CHAR@"+f,h=k[c];if(h)return f=
h.nextPos,h.result;a.substr(f).match(/^[^ \t\n\r\u3000+\-!():^[\]"{}~*?\\]/)!==null?(h=a.charAt(f),f++):(h=null,j&&i('[^ \t\\n\\r\\u3000+\\-!():^[\\]"{}~*?\\\\]'));k[c]={nextPos:f,result:h};return h}function v(){var c="TERM_CHAR@"+f,h=k[c];if(h)return f=h.nextPos,h.result;h=u();h===null&&(h=A(),h===null&&(a.substr(f,1)==="-"?(h="-",f+=1):(h=null,j&&i('"-"')),h===null&&(a.substr(f,1)==="+"?(h="+",f+=1):(h=null,j&&i('"+"')),h=h!==null?h:null)));k[c]={nextPos:f,result:h};return h}function w(){var a=
"Term@"+f,b=k[a];if(b)return f=b.nextPos,b.result;b=j;j=!1;var c=f,d=u();if(d!==null){for(var e=[],m=v();m!==null;)e.push(m),m=v();e!==null?d=[d,e]:(d=null,f=c)}else d=null,f=c;c=d!==null?[d[0]].concat(d[1]).join(""):null;(j=b)&&c===null&&i("term");k[a]={nextPos:f,result:c};return c}function y(){var c="Boost@"+f,h=k[c];if(h)return f=h.nextPos,h.result;h=j;j=!1;var d=f;if(a.substr(f,1)==="^"){var e="^";f+=1}else e=null,j&&i('"^"');if(e!==null){var n=z();n!==null?e=[e,n]:(e=null,f=d)}else e=null,f=
d;d=e!==null?e:"";d=d!==null?function(a){a&&(a=a[1]);return typeof a==="number"?a:1}(d):null;(j=h)&&d===null&&i("boost");k[c]={nextPos:f,result:d};return d}function B(){var c="TermQuery@"+f,d=k[c];if(d)return f=d.nextPos,d.result;var e=d=f,g=w();if(g!==null){if(a.substr(f,1)===":"){var n=":";f+=1}else n=null,j&&i('":"');n!==null?g=[g,n]:(g=null,f=e)}else g=null,f=e;e=g!==null?g:"";e!==null?(g=w(),g!==null?(n=y(),n!==null?e=[e,g,n]:(e=null,f=d)):(e=null,f=d)):(e=null,f=d);d=e!==null?new TermQuery(e[0]?
e[0][0]:H,e[1],e[2]):null;k[c]={nextPos:f,result:d};return d}function s(){var c="BooleanClause@"+f,d=k[c];if(d)return f=d.nextPos,d.result;d=f;if(a.substr(f,1)==="+"){var e="+";f+=1}else e=null,j&&i('"+"');e===null&&(a.substr(f,1)==="-"?(e="-",f+=1):(e=null,j&&i('"-"')),e=e!==null?e:null);e=e!==null?e:"";if(e!==null){var g=C();g===null&&(g=B(),g=g!==null?g:null);g!==null?e=[e,g]:(e=null,f=d)}else e=null,f=d;d=e!==null?function(a,b){a=a==="+"?Occur.MUST:a==="-"?Occur.MUST_NOT:Occur.SHOULD;return new BooleanClause(b,
a)}(e[0],e[1]):null;k[c]={nextPos:f,result:d};return d}function D(){var a="BooleanQuery@"+f,b=k[a];if(b)return f=b.nextPos,b.result;var b=f,c=s();if(c!==null){var d=[],e=f,g=q();if(g!==null){var i=s();i!==null?g=[g,i]:(g=null,f=e)}else g=null,f=e;for(;g!==null;)d.push(g),e=f,g=q(),g!==null?(i=s(),i!==null?g=[g,i]:(g=null,f=e)):(g=null,f=e);d!==null?c=[c,d]:(c=null,f=b)}else c=null,f=b;b=c!==null?function(a,b){var c=[a];if(b)for(var d=0,e=b.length;d<e;++d)c[c.length]=b[d][1];return new BooleanQuery(c)}(c[0],
c[1]):null;k[a]={nextPos:f,result:b};return b}function C(){var c="SubQuery@"+f,d=k[c];if(d)return f=d.nextPos,d.result;d=f;if(a.substr(f,1)==="("){var e="(";f+=1}else e=null,j&&i('"("');if(e!==null){var g=E();if(g!==null){if(a.substr(f,1)===")"){var n=")";f+=1}else n=null,j&&i('")"');if(n!==null){var m=y();m!==null?e=[e,g,n,m]:(e=null,f=d)}else e=null,f=d}else e=null,f=d}else e=null,f=d;d=e!==null?function(a,b){a.boost=b;return a}(e[1],e[3]):null;k[c]={nextPos:f,result:d};return d}function E(){var a=
"Query@"+f,b=k[a];if(b)return f=b.nextPos,b.result;var b=f,c=q();if(c!==null){var d=D();if(d!==null){var e=q();e!==null?c=[c,d,e]:(c=null,f=b)}else c=null,f=b}else c=null,f=b;b=c!==null?c[1]:null;k[a]={nextPos:f,result:b};return b}function I(){var c=function(a){a.sort();for(var b=null,c=[],d=0;d<a.length;d++)a[d]!==b&&(c.push(a[d]),b=a[d]);switch(c.length){case 0:return"end of input";case 1:return c[0];default:return c.slice(0,c.length-1).join(", ")+" or "+c[c.length-1]}}(t),d=Math.max(f,p),d=d<a.length?
g(a.charAt(d)):"end of input";return"Expected "+c+" but "+d+" found."}function J(){for(var c=1,d=1,e=!1,f=0;f<p;f++){var g=a.charAt(f);g==="\n"?(e||c++,d=1,e=!1):g==="\r"|g==="\u2028"||g==="\u2029"?(c++,d=1,e=!0):(d++,e=!1)}return{line:c,column:d}}var G={BooleanClause:s,BooleanQuery:D,Boost:y,ESCAPED_CHAR:A,Number:z,Query:E,SKIP:q,SubQuery:C,TERM_CHAR:v,TERM_START_CHAR:u,Term:w,TermQuery:B,WHITESPACE:o};if(c!==void 0){if(G[c]===void 0)throw Error("Invalid rule name: "+g(c)+".");}else c="Query";var f=
0,j=!0,p=0,t=[],k={},H=d||null,c=G[c]();if(c===null||f!==a.length)throw c=J(),new this.SyntaxError(I(),c.line,c.column);return c},toSource:function(){return typeof this._source==="string"?this._source:this.toString()},SyntaxError:function(a,c,d){this.name="SyntaxError";this.message=a;this.line=c;this.column=d}};a.SyntaxError.prototype=Error.prototype;return a}();function Searcher(a){this._index=a}Searcher.prototype.similarity=new DefaultSimilarity;
Searcher.prototype.search=function(a,b,c){b=new TopDocumentsCollector(b,c);(new NormalizedQuery(a)).score(this.similarity,this._index).pipe(b)};exports.Searcher=Searcher;function TermQuery(a,b,c){this.field=a||null;this.term=b;this.boost=c||1}TermQuery.prototype.field=null;TermQuery.prototype.boost=1;TermQuery.prototype.score=function(a,b){var c=new TermScorer(this,a);b.getTermVectors(this.field,this.term).pipe(c);return c};TermQuery.prototype.extractTerms=function(){return[{term:this.term,field:this.field}]};
TermQuery.prototype.rewrite=function(){return this};function TermScorer(a,b){Stream.call(this);this._boost=a.boost;this._similarity=b}TermScorer.prototype=Object.create(Stream.prototype);TermScorer.prototype.onWrite=function(a){var b=this._similarity,c=new DocumentTerms(a.documentID,[a]),d=b.idf(a);c.sumOfSquaredWeights=d*this._boost*d*this._boost;c.score=b.tf(a)*d*d*this._boost*b.norm(a);this.emit(c)};
TermScorer.prototype.onBulkWrite=function(a){var b=this._similarity,c,d,e,g=Array(a.length);x=0;for(xl=a.length;x<xl;++x)c=a[x],d=new DocumentTerms(c.documentID,[c]),e=b.idf(c),d.sumOfSquaredWeights=e*this._boost*e*this._boost,d.score=b.tf(c)*e*e*this._boost*b.norm(c),g[x]=d;this.emitBulk(g)};exports.TermQuery=TermQuery;function TermRangeQuery(a,b,c,d,e,g){this.field=a||null;this.startTerm=b;this.endTerm=c;this.excludeStart=d||!1;this.excludeEnd=e||!1;this.boost=g||1}
TermRangeQuery.prototype.field=null;TermRangeQuery.prototype.excludeStart=!1;TermRangeQuery.prototype.excludeEnd=!1;TermRangeQuery.prototype.boost=1;TermRangeQuery.prototype.score=function(a,b){var c=new TermScorer(this,a);b.getTermRangeVectors(this.field,this.startTerm,this.endTerm,this.excludeStart,this.excludeEnd).pipe(c);return c};TermRangeQuery.prototype.extractTerms=function(){return[{term:this.startTerm,field:this.field}]};TermRangeQuery.prototype.rewrite=function(){return this};
exports.TermRangeQuery=TermRangeQuery;function TopDocumentsCollector(a,b){Collector.call(this,b);this.max=a||1}TopDocumentsCollector.compareScores=function(a,b){return b.score-a.score};TopDocumentsCollector.prototype=Object.create(Collector.prototype);TopDocumentsCollector.prototype.lowestScore=0;
TopDocumentsCollector.prototype.onWrite=function(a){if(this.collection.length<this.max||a.score>this.lowestScore)this.collection.length>=this.max&&this.collection.pop(),Array.orderedInsert(this.collection,a,TopDocumentsCollector.compareScores),this.lowestScore=this.collection[this.collection.length-1].score};
TopDocumentsCollector.prototype.onBulkWrite=function(a){var b,c;b=0;for(c=a.length;b<c;++b)if(this.collection.length<this.max||a[b].score>this.lowestScore)this.collection.length>=this.max&&this.collection.pop(),Array.orderedInsert(this.collection,a[b],TopDocumentsCollector.compareScores),this.lowestScore=this.collection[this.collection.length-1].score};exports.TopDocumentsCollector=TopDocumentsCollector;
